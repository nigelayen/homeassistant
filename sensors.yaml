# Host
- platform: systemmonitor
  resources:
    - type: processor_use
    - type: disk_use_percent
      arg: /
    - type: memory_use_percent
    - type: swap_use_percent
    - type: last_boot

# Sensors

# next collection
- platform: waste_collection_schedule
  name: next_collection
# next Green Bin collection
- platform: waste_collection_schedule
  name: next_greenbin_collection
  types:
    - Organics
# next Blue Bin collection
- platform: waste_collection_schedule
  name: next_bluebin_collection
  types:
    - Recycling
# next garbage collection
- platform: waste_collection_schedule
  name: next_garbage_collection
  types:
    - Garbage

- platform: template
  sensors:
    front_door_sensor_battery_level:
      friendly_name: "Front Door Sensor Battery Level"
      unit_of_measurement: "%"
      value_template: "{{ state_attr('binary_sensor.front_door', 'battery_level') }}"
    back_door_sensor_battery_level:
      friendly_name: "Back Door Sensor Battery Level"
      unit_of_measurement: "%"
      value_template: "{{ state_attr('binary_sensor.back_door', 'battery_level') }}"
    motion_sensor_battery_level:
      friendly_name: "Motion Sensor Battery Level"
      unit_of_measurement: "%"
      value_template: "{{ state_attr('binary_sensor.hue_motion_sensor_1_motion', 'battery_level') }}"
    ring_range_extender_battery_level:
      friendly_name: "Ring Range Extender Battery Level"
      unit_of_measurement: "%"
      value_template: "{{ state_attr('sensor.living_room_info_2', 'batteryLevel') }}"
    ring_range_extender_comm_status:
      friendly_name: "Ring Range Extender Communication Status"
      value_template: "{{ state_attr('sensor.living_room_info_2', 'commStatus') }}"
    indoor_temperature:
      friendly_name: "Indoor Temperature"
      value_template: "{{ ((int(state_attr('climate.main_floor', 'current_temperature')) + int(states('sensor.motion_sensor_temperature')))/2)|round(0) }}"
    hydro_ontario_cost:
      unit_of_measurement: "CAD/kWh"
      value_template: >-
        {## https://www.torontohydro.com/for-home/rates ##}
        {% set prices = {
          "off_peak": 0.082,
          "mid_peak": 0.113,
          "on_peak": 0.17,
          "delivery": 0.07,
        } %}

        {% if is_state('binary_sensor.workday_sensor', 'off') %}
          {{ prices.off_peak + prices.delivery }}
        {% else %}
        {% if now().month <= 4 or now().month >= 11 %}
        {% if now().hour >= 7 and now().hour < 11 %}
          {{ prices.on_peak + prices.delivery }}
        {% elif now().hour >= 11 and now().hour < 17 %}
          {{ prices.mid_peak + prices.delivery }}
        {% elif now().hour >= 17 and now().hour < 19 %}
          {{ prices.on_peak + prices.delivery }}
        {% else %}
          {{ prices.off_peak + prices.delivery }}
        {% endif %}
        {% else %}
        {% if now().hour >= 7 and now().hour < 11 %} 
         {{ prices.mid_peak + prices.delivery }} 
        {% elif now().hour >= 11 and now().hour < 17 %}
          {{ prices.on_peak + prices.delivery }}
        {% elif now().hour >= 17 and now().hour < 19 %}
          {{ prices.mid_peak + prices.delivery }}
        {% else %}
          {{ prices.off_peak + prices.delivery }}
        {% endif %}
        {% endif %}
        {% endif %}
